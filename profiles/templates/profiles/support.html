{% extends "base.html" %}
{% load static %}
{% load crispy_forms_tags %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'profiles/css/profiles.css' %}">
{% endblock %}

{% block page_header %}
<div class="container header-container">
    <div class="row">
        <div class="col"></div>
    </div>
</div>
{% endblock %}

{% block content %}

<div class="overlay"></div>
<div class="container">
    <div class="header-margin">
        <div class="row">
            <div class="col-12">
                <hr>
                <h2 class="text-center"><i class="fas fa-question-circle mb-0"></i></h2>
            </div>
            <div class="col-12">
                <h2 class="mb-4 text-center">Support Centre</h2>
                <h5 class="text-center">Open Tickets</h5>
            </div>
            <hr>
        </div>



        <div class="container border mb-2 py-3 wrapper">

            {% for ticket in tickets_open %}
            <div class="row d-flex justify-content-center">
                <div class="col-8 col-md-5">
                    <div class="font-weight-bold overflow-hidden">
                        {{ ticket.title }}
                    </div>
                    <div class="overflow-hidden">
                        {{ ticket.query|truncatechars:75 }}
                    </div>
                </div>
                <div class="col-4 col-md-2">

                    <div class="my-auto mx-auto">
                        <a class="btn btn-info btn-block rounded-0" href="{% url 'ticket-details' ticket.id %}">View
                            Ticket</a>
                    </div>
                </div>
            </div>
            <hr>
            {% empty %}
            <div class="jumbotron text-center">
                You don't have any open support tickets. <a href="{% url 'add-support-ticket' %}">Click here</a>
                to add a query.
            </div>
            {% endfor %}
    
        </div>
        <div class="row">
            <div class="col-12">
                <p class="text-center"><a class="btn btn-success rounded-0 mt-3"
                        href="{% url 'add-support-ticket' %}">New Ticket</a></p>
            </div>
        </div>

        
    </div>
</div>

</div>
{% endblock %}

{% block postloadjs %}
{{ block.super }}
<script type="text/javascript" src="{% static 'profiles/js/countryfield.js' %}"></script>
{% endblock %}